<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì»´í“¨í„°ì‹¤ ëª°ë˜ ê²Œì„: ì „ìš© ëª¨ë‹ˆí„° ëª¨ë“œ V21</title>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: #00ff00; font-family: 'DungGeunMo', sans-serif; margin: 0; overflow: hidden; }
        
        /* 1. ë¡œë¹„ (ì„ íƒ í™”ë©´) */
        #lobby { position: fixed; inset: 0; background: #111; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .lobby-title { font-size: 2.5rem; color: #f1c40f; margin-bottom: 40px; }
        .btn-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .monitor-btn { width: 200px; height: 120px; font-family: 'DungGeunMo'; font-size: 1.2rem; cursor: pointer; background: #333; color: white; border: 5px outset #888; }
        .monitor-btn:hover { background: #444; color: #0ff; }
        .monitor-btn.red { border-color: #e74c3c; }
        .monitor-btn.blue { border-color: #3498db; }

        /* 2. ê²Œì„ ë ˆì´ì•„ì›ƒ */
        #game-container { display: none; flex-direction: column; align-items: center; width: 100vw; height: 100vh; }
        #header { width: 100%; padding: 15px; background: #222; border-bottom: 4px inset #555; display: flex; flex-direction: column; align-items: center; }
        .time-bar-bg { width: 80%; height: 20px; background: #111; border: 2px inset #555; margin-top: 10px; }
        #time-bar { width: 100%; height: 100%; background: #00ff00; transition: width 0.1s linear; }

        /* 3. ë‹¨ì¼ ëª¨ë‹ˆí„° ë·° */
        .main-stage { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 90%; }
        .teacher-box { width: 120px; height: 90px; font-size: 4rem; display: flex; justify-content: center; align-items: center; background: #333; border: 5px solid #555; border-radius: 15px 15px 0 0; margin-bottom: -5px; }
        .teacher-box.watching { background: #ff0000; animation: shake 0.1s infinite; }

        .monitor-frame { width: 100%; max-width: 900px; border: 12px outset #aaa; background: #000; padding: 20px; box-sizing: border-box; }
        .monitor-frame.red-team { border-color: #e74c3c; }
        .monitor-frame.blue-team { border-color: #3498db; }

        .board { display: grid; grid-template-columns: repeat(8, 1fr); gap: 5px; width: 100%; }
        .card { height: 30px; background: #222; color: #444; font-size: 0.8rem; display: flex; justify-content: center; align-items: center; border-radius: 4px; text-align: center; }
        .card.red { background: #e74c3c; color: white; box-shadow: inset -3px -3px 0 #962d22; }
        .card.blue { background: #3498db; color: white; box-shadow: inset -3px -3px 0 #2471a3; }

        .input-area { margin-top: 25px; width: 100%; }
        #player-input { width: 100%; padding: 15px; font-family: 'DungGeunMo'; font-size: 1.8rem; background: #000; color: #fff; border: 4px solid #555; outline: none; text-align: center; }
        #player-input.caught { border-color: red; background: #400; }

        @keyframes shake { 0% { transform: translateY(-2px); } 100% { transform: translateY(2px); } }
    </style>
</head>
<body>

<div id="lobby">
    <div class="lobby-title">ìì‹ ì˜ ìë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
    <div class="btn-grid">
        <button class="monitor-btn red" onclick="enterMonitor(1)">ëª¨ë‹ˆí„° 1<br>(ë¹¨ê°•íŒ€)</button>
        <button class="monitor-btn blue" onclick="enterMonitor(2)">ëª¨ë‹ˆí„° 2<br>(íŒŒë‘íŒ€)</button>
        <button class="monitor-btn red" onclick="enterMonitor(3)">ëª¨ë‹ˆí„° 3<br>(ë¹¨ê°•íŒ€)</button>
        <button class="monitor-btn blue" onclick="enterMonitor(4)">ëª¨ë‹ˆí„° 4<br>(íŒŒë‘íŒ€)</button>
    </div>
</div>

<div id="game-container">
    <div id="header">
        <div id="timer-text" style="font-size: 1.5rem;">ë‚¨ì€ ìˆ˜ì—… ì‹œê°„: 300.0s</div>
        <div class="time-bar-bg"><div id="time-bar"></div></div>
    </div>

    <div class="main-stage">
        <div id="teacher" class="teacher-box">ğŸ‘¨â€ğŸ«</div>
        <div id="monitor-frame" class="monitor-frame">
            <div id="board" class="board"></div>
            <div class="input-area">
                <input type="text" id="player-input" placeholder="ì„ ìƒë‹˜ì´ ì•ˆ ë³¼ ë•Œ ì…ë ¥!">
            </div>
        </div>
        <div id="my-info" style="margin-top: 15px; font-size: 1.2rem;"></div>
    </div>
</div>

<script>
    const schoolWords = ["ë–¡ë³¶ì´", "ê¸‰ì‹", "ìš´ë™ì¥", "ë°›ì•„ì“°ê¸°", "ë°©í•™", "ìš°ìœ ê¸‰ì‹", "ì•Œë¦¼ì¥", "ì§ê¿", "ì¤€ë¹„ë¬¼", "ì‹¤ë‚´í™”", "ìƒ‰ì¢…ì´", "ë”±ì§€", "ìŠ¬ëŸ¬ì‹œ", "í”¼ì¹´ì¸„", "í•™ì›", "ìˆ™ì œ", "ì²´ìœ¡", "ì†Œí’", "ì‰¬ëŠ”ì‹œê°„", "ì§€ìš°ê°œ", "í•„í†µ", "ì‹¤ë¡œí°", "ë¦¬ì½”ë”", "ë°˜ì¥", "ì¼ê¸°", "ë…ì„œ", "í”¼êµ¬", "íƒœê¶Œë„", "ë¬¸ë°©êµ¬", "ë½‘ê¸°", "ë¶„ì‹ì§‘", "êµì‹¤", "ëª¨ë‘ í™œë™", "êµì¥ì„ ìƒë‹˜", "ìš´ë™íšŒ", "ë§¤ì ", "ì¹ íŒ", "ë¶„í•„", "ì‹¤ë‚´í™”ê°€ë°©", "ì •ë¬¸"];

    let timeLeft = 3000;
    let isTeacherWatching = false;
    let myPlayerId = 0;
    let myTeam = '';
    
    // ì´ ê°ì²´ê°€ ì„œë²„ ì—­í• ì„ ëŒ€ì‹ í•˜ì—¬ ëª¨ë“  "ê°€ìƒ" ëª¨ë‹ˆí„°ì˜ ìƒíƒœë¥¼ ì €ì¥í•©ë‹ˆë‹¤.
    const gameState = {
        cards: {}, // ë‹¨ì–´ë³„ ì†Œìœ  íŒ€ ì €ì¥
        teamLog: { red: [], blue: [] }
    };

    function enterMonitor(id) {
        myPlayerId = id;
        myTeam = (id === 1 || id === 3) ? 'red' : 'blue';
        
        document.getElementById('lobby').style.display = 'none';
        document.getElementById('game-container').style.display = 'flex';
        document.getElementById('monitor-frame').classList.add(myTeam === 'red' ? 'red-team' : 'blue-team');
        document.getElementById('my-info').innerText = `ë‹¹ì‹ ì€ ${id}ë²ˆ ìë¦¬ (${myTeam === 'red' ? 'ë¹¨ê°•íŒ€' : 'íŒŒë‘íŒ€'}) ì…ë‹ˆë‹¤.`;
        
        initBoard();
        startSyncGame();
    }

    function initBoard() {
        const board = document.getElementById('board');
        schoolWords.forEach(w => {
            const c = document.createElement('div');
            c.className = 'card';
            c.innerText = w;
            c.id = `card-${w}`;
            board.appendChild(c);
            gameState.cards[w] = null; // ì´ˆê¸°ì—” ì£¼ì¸ ì—†ìŒ
        });
    }

    function startSyncGame() {
        // íƒ€ì´ë¨¸ ì‹œì‘
        const timer = setInterval(() => {
            if(timeLeft > 0) {
                timeLeft--;
                updateUI();
            } else {
                clearInterval(timer);
                alert(`ê²Œì„ ì¢…ë£Œ! ê²°ê³¼ëŠ” ì ì‹œ í›„ ê³µê°œë©ë‹ˆë‹¤.`);
                location.reload();
            }
        }, 100);

        scheduleTeacher();
        setupInput();
    }

    function updateUI() {
        document.getElementById('time-bar').style.width = (timeLeft / 3000) * 100 + "%";
        document.getElementById('timer-text').innerText = `ë‚¨ì€ ìˆ˜ì—… ì‹œê°„: ${(timeLeft / 10).toFixed(1)}s`;
        
        // ì¹´ë“œ ìƒíƒœ ë™ê¸°í™” (ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ë¶€ë¶„)
        schoolWords.forEach(w => {
            const cardElement = document.getElementById(`card-${w}`);
            if (gameState.cards[w]) {
                cardElement.className = `card ${gameState.cards[w]}`;
            } else {
                cardElement.className = 'card';
            }
        });
    }

    function scheduleTeacher() {
        setTimeout(() => {
            isTeacherWatching = true;
            document.getElementById('teacher').classList.add('watching');
            document.getElementById('teacher').innerText = "ğŸ‘€";

            setTimeout(() => {
                isTeacherWatching = false;
                document.getElementById('teacher').classList.remove('watching');
                document.getElementById('teacher').innerText = "ğŸ‘¨â€ğŸ«";
                scheduleTeacher();
            }, 2000);
        }, 18000);
    }

    function setupInput() {
        const input = document.getElementById('player-input');
        input.focus();

        input.addEventListener('keydown', (e) => {
            if (isTeacherWatching) {
                input.classList.add('caught');
                setTimeout(() => input.classList.remove('caught'), 500);
                
                // ê±¸ë ¸ì„ ë•Œ íŒ¨ë„í‹° (ìš°ë¦¬ íŒ€ ì¹´ë“œ í•˜ë‚˜ ëª°ìˆ˜)
                if (gameState.teamLog[myTeam].length > 0) {
                    const lostWord = gameState.teamLog[myTeam].pop();
                    gameState.cards[lostWord] = null;
                }
                
                input.value = '';
                e.preventDefault();
                return;
            }

            if (e.key === 'Enter') {
                const val = input.value.trim();
                // ë‹¨ì–´ê°€ ë§ê³ , ì•„ì§ ì£¼ì¸ì´ ì—†ì„ ë•Œë§Œ ì ìˆ˜ íšë“
                if (schoolWords.includes(val) && !gameState.cards[val]) {
                    gameState.cards[val] = myTeam;
                    gameState.teamLog[myTeam].push(val);
                }
                input.value = '';
            }
        });
    }

    // ì°½ì„ ì—¬ëŸ¬ ê°œ ë„ì› ì„ ë•Œ ì„œë¡œ í†µì‹ í•˜ê²Œ í•˜ë ¤ë©´ ì›ë˜ ì„œë²„ê°€ í•„ìš”í•˜ì§€ë§Œ, 
    // ì§€ê¸ˆì€ í•œ í™”ë©´ì—ì„œ ë²„íŠ¼ì„ ëˆŒëŸ¬ "ë‚´ ìë¦¬"ë¡œ ë“¤ì–´ê°€ëŠ” ì—°ì¶œë¡œ êµ¬ì„±í–ˆìŠµë‹ˆë‹¤.
</script>
</body>
</html>
