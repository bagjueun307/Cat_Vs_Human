<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì´ˆë“±í•™êµ ì»´í“¨í„°ì‹¤: 5ë¶„ì˜ í˜ˆíˆ¬ V17</title>
    <link href="https://fonts.googleapis.com/css2?family=DungGeunMo&display=swap" rel="stylesheet">
    <style>
        body { background: #000; color: #00ff00; font-family: 'DungGeunMo', sans-serif; margin: 0; overflow: hidden; display: flex; flex-direction: column; align-items: center; }
        #header { width: 100%; padding: 10px; background: #222; border-bottom: 4px inset #555; display: flex; flex-direction: column; align-items: center; }
        .time-container { width: 90%; height: 15px; background: #111; border: 2px inset #555; margin: 5px 0; overflow: hidden; }
        #time-bar { width: 100%; height: 100%; background: #00ff00; transition: width 0.1s linear; }

        #game-grid { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; width: 100vw; height: 82vh; gap: 15px; padding: 20px; box-sizing: border-box; }
        .monitor-container { position: relative; display: flex; flex-direction: column; align-items: center; transition: all 0.6s; }
        
        .teacher-box { 
            width: 80px; height: 60px; font-size: 2.5rem; display: flex; justify-content: center; align-items: center;
            background: #333; border: 4px solid #555; border-radius: 10px 10px 0 0; margin-bottom: -4px; transition: 0.2s;
        }
        .teacher-box.warn { background: #ffeb3b; color: #000; } 
        .teacher-box.watching { background: #ff0000; color: #fff; animation: shake 0.1s infinite; } 

        .monitor { width: 100%; border: 8px outset #aaa; background: #000; display: flex; flex-direction: column; align-items: center; padding: 10px; }
        .red-mon { border-color: #e74c3c; }
        .blue-mon { border-color: #3498db; }

        .board { display: grid; grid-template-columns: repeat(8, 1fr); gap: 3px; }
        .card { width: 45px; height: 22px; background: #222; color: #444; font-size: 0.5rem; display: flex; justify-content: center; align-items: center; border-radius: 2px; text-align: center; }
        .card.red { background: #e74c3c; color: white; box-shadow: inset -2px -2px 0 #962d22; }
        .card.blue { background: #3498db; color: white; box-shadow: inset -2px -2px 0 #2471a3; }

        .input-wrap { margin-top: 10px; width: 90%; }
        input { width: 100%; padding: 8px; font-family: 'DungGeunMo'; background: #000; color: #fff; border: 2px solid #555; outline: none; text-align: center; font-size: 1rem; }
        input.caught { border-color: red !important; background: #400 !important; animation: flash 0.3s; }

        #bonus-modal { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 70%; background: #000; border: 10px double #f1c40f; padding: 40px; display: none; flex-direction: column; align-items: center; z-index: 2000; }
        @keyframes shake { 0% { transform: translateY(-2px); } 100% { transform: translateY(2px); } }
        @keyframes flash { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
    </style>
</head>
<body>

<div id="header">
    <div id="timer-text" style="font-size: 1.2rem;">ì»´í“¨í„° ìˆ˜ì—… ì¢…ë£Œê¹Œì§€: 300.0s</div>
    <div class="time-container"><div id="time-bar"></div></div>
    <div style="font-size: 0.8rem; color: #ffeb3b;">ì„ ìƒë‹˜ì´ ë³¼ ë•Œ(ğŸ‘€) íƒ€ì´í•‘ ê¸ˆì§€! ì»µë–¡ë³¶ì´ ë‚´ê¸° 5ë¶„ ìŠ¹ë¶€!</div>
</div>

<div id="bonus-modal">
    <div style="color: #f1c40f; font-size: 1.2rem; margin-bottom: 15px;">âš¡ ë§ˆì§€ë§‰ ìŠ¤í”¼ë“œ íƒ€ì ëŒ€ê²° (ì—­ì „ì˜ ê¸°íšŒ!) âš¡</div>
    <div id="bonus-q" style="font-size: 1.5rem; margin-bottom: 20px; text-align: center; color: #fff;"></div>
    <input type="text" id="bonus-in" placeholder="ë¬¸ì¥ì„ ë˜‘ê°™ì´ ì…ë ¥í•˜ì„¸ìš”!">
</div>

<div id="game-grid">
    <div id="cont-1" class="monitor-container"><div id="t-1" class="teacher-box">ğŸ‘¨â€ğŸ«</div><div class="monitor red-mon"><div class="board" id="b-1"></div><div class="input-wrap"><input type="text" id="in-1" placeholder="RED 1" onfocus="lastTeam='red'"></div></div></div>
    <div id="cont-2" class="monitor-container"><div id="t-2" class="teacher-box">ğŸ‘¨â€ğŸ«</div><div class="monitor blue-mon"><div class="board" id="b-2"></div><div class="input-wrap"><input type="text" id="in-2" placeholder="BLUE 1" onfocus="lastTeam='blue'"></div></div></div>
    <div id="cont-3" class="monitor-container"><div id="t-3" class="teacher-box">ğŸ‘¨â€ğŸ«</div><div class="monitor red-mon"><div class="board" id="b-3"></div><div class="input-wrap"><input type="text" id="in-3" placeholder="RED 2" onfocus="lastTeam='red'"></div></div></div>
    <div id="cont-4" class="monitor-container"><div id="t-4" class="teacher-box">ğŸ‘¨â€ğŸ«</div><div class="monitor blue-mon"><div class="board" id="b-4"></div><div class="input-wrap"><input type="text" id="in-4" placeholder="BLUE 2" onfocus="lastTeam='blue'"></div></div></div>
</div>

<script>
    // ì´ˆë“±í•™ìƒ ë§ì¶¤í˜• ë‹¨ì–´ ì„¸íŠ¸
    const schoolWords = [
        "ë–¡ë³¶ì´", "ê¸‰ì‹", "ìš´ë™ì¥", "ë°›ì•„ì“°ê¸°", "ë°©í•™", "ìš°ìœ ê¸‰ì‹", "ì•Œë¦¼ì¥", "ì§ê¿", 
        "ì¤€ë¹„ë¬¼", "ì‹¤ë‚´í™”", "ìƒ‰ì¢…ì´", "ë”±ì§€", "ìŠ¬ëŸ¬ì‹œ", "í”¼ì¹´ì¸„", "í•™ì›", "ìˆ™ì œ", 
        "ì²´ìœ¡", "ì†Œí’", "ì‰¬ëŠ”ì‹œê°„", "ì¹ íŒ", "ì§€ìš°ê°œ", "í•„í†µ", "ì‹¤ë¡œí°", "ë¦¬ì½”ë”", 
        "ê³¼í•™ì‹¤", "ìš´ë™íšŒ", "ë°˜ì¥", "ì¼ê¸°", "ë…ì„œ", "í”¼êµ¬", "ì»´í“¨í„°", "íƒœê¶Œë„",
        "ë™ë„¤í•œë°”í€´", "ë¬¸ë°©êµ¬", "ë½‘ê¸°", "ë¶„ì‹ì§‘", "êµì‹¤", "ê¸‰ì‹ì†Œ", "ì‹¤ë‚´í™”ê°€ë°©", "ë°›ì•„ì“°ê¸°"
    ];
    
    const bonusSentences = [
        "ì˜¤ëŠ˜ í•™êµ ëë‚˜ê³  ì •ë¬¸ ì• ë¬¸ë°©êµ¬ì—ì„œ ë§Œë‚˜ì",
        "ì„ ìƒë‹˜ ëª°ë˜ í•˜ëŠ” ì»´í“¨í„° ê²Œì„ì´ ì œì¼ ì¬ë°Œë‹¤",
        "ì»µë–¡ë³¶ì´ì— í”¼ì¹´ì¸„ ëˆê¹ŒìŠ¤ê¹Œì§€ ì¶”ê°€í•´ì„œ ë¨¹ì„ë˜"
    ];

    const GAME_TOTAL_TIME = 3000; // 300ì´ˆ (0.1ì´ˆ ë‹¨ìœ„)
    let timeLeft = GAME_TOTAL_TIME;
    let isBonus = false;
    let isTeacherWatching = false;
    let lastTeam = 'red';
    let teamLog = { red: [], blue: [] };

    function init() {
        for(let i=1; i<=4; i++) {
            const b = document.getElementById(`b-${i}`);
            schoolWords.forEach(w => {
                const c = document.createElement('div');
                c.className = 'card'; c.innerText = w; c.id = `c-${i}-${w}`;
                b.appendChild(c);
            });
            setupInput(i);
        }
        setupBonus();
        startTimers();
        scheduleTeacher();
    }

    function startTimers() {
        setInterval(() => {
            if(timeLeft > 0) timeLeft--;
            document.getElementById('time-bar').style.width = (timeLeft / GAME_TOTAL_TIME) * 100 + "%";
            document.getElementById('timer-text').innerText = isBonus ? "ë³´ë„ˆìŠ¤ íƒ€ì„!" : `ì»´í“¨í„° ìˆ˜ì—… ì¢…ë£Œê¹Œì§€: ${(timeLeft / 10).toFixed(1)}s`;
            if(timeLeft <= 0) {
                if(!isBonus) startBonus();
                else finishGame();
            }
        }, 100);

        setInterval(() => {
            if(!isBonus && !isTeacherWatching) {
                let orders = [1,2,3,4].sort(()=>Math.random()-0.5);
                for(let i=1; i<=4; i++) document.getElementById(`cont-${i}`).style.order = orders[i-1];
            }
        }, 10000);
    }

    function scheduleTeacher() {
        setTimeout(() => {
            if(isBonus) return;
            const boxes = document.querySelectorAll('.teacher-box');
            boxes.forEach(b => { b.classList.add('warn'); b.innerText = "â“"; });

            setTimeout(() => {
                isTeacherWatching = true;
                boxes.forEach(b => { b.classList.remove('warn'); b.classList.add('watching'); b.innerText = "ğŸ‘€"; });

                setTimeout(() => {
                    isTeacherWatching = false;
                    boxes.forEach(b => { b.classList.remove('watching'); b.innerText = "ğŸ‘¨â€ğŸ«"; });
                    scheduleTeacher();
                }, 2000);
            }, 1000);
        }, 17000); 
    }

    function setupInput(id) {
        const input = document.getElementById(`in-${id}`);
        input.addEventListener('keydown', (e) => {
            const container = document.getElementById(`cont-${id}`);
            const team = container.querySelector('.monitor').classList.contains('red-mon') ? 'red' : 'blue';

            if(isTeacherWatching) {
                input.classList.add('caught');
                setTimeout(() => input.classList.remove('caught'), 500);
                if(teamLog[team].length > 0) {
                    const lost = teamLog[team].pop();
                    for(let j=1; j<=4; j++) {
                        document.getElementById(`c-${j}-${lost}`).className = 'card';
                    }
                }
                input.value = '';
                e.preventDefault();
                return;
            }

            if(e.key === 'Enter') {
                const val = input.value.trim();
                if(schoolWords.includes(val)) {
                    for(let j=1; j<=4; j++) {
                        document.getElementById(`c-${j}-${val}`).className = `card ${team}`;
                    }
                    if(!teamLog[team].includes(val)) teamLog[team].push(val);
                }
                input.value = '';
            }
        });
    }

    function startBonus() {
        isBonus = true;
        isTeacherWatching = false;
        document.getElementById('bonus-modal').style.display = 'flex';
        const q = bonusSentences[Math.floor(Math.random()*bonusSentences.length)];
        document.getElementById('bonus-q').innerText = q;
        document.getElementById('bonus-in').focus();
    }

    function setupBonus() {
        const bIn = document.getElementById('bonus-in');
        bIn.addEventListener('keydown', (e) => {
            if(e.key === 'Enter' && isBonus) {
                if(bIn.value.trim() === document.getElementById('bonus-q').innerText) {
                    awardBonus(lastTeam);
                    finishGame();
                }
            }
        });
    }

    function awardBonus(team) {
        let count = 0;
        let shuffled = [...schoolWords].sort(() => Math.random() - 0.5);
        for(let w of shuffled) {
            if(count >= 4) break;
            for(let j=1; j<=4; j++) document.getElementById(`c-${j}-${w}`).className = `card ${team}`;
            count++;
        }
    }

    function finishGame() {
        const r = document.querySelectorAll('#b-1 .card.red').length;
        const b = document.querySelectorAll('#b-1 .card.blue').length;
        const loser = r > b ? "íŒŒë‘íŒ€" : "ë¹¨ê°•íŒ€";
        alert(`5ë¶„ê°„ì˜ ëŒ€ê²° ì¢…ë£Œ!\nìµœì¢… ê²°ê³¼ - ë¹¨ê°•: ${r} : íŒŒë‘: ${b}\n\n${loser} ë„ˆ í•™êµ ëë‚˜ê³  ì»µë–¡ë³¶ì´ ì˜ëŠ” ê±° ìŠì§€ ë§ˆ!`);
        location.reload();
    }

    init();
</script>
</body>
</html>
